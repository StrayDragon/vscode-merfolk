## Context

当前 Mermaid 预览面板使用了一个顶部工具栏来提供缩放控制（Zoom In/Out/Reset/Fit）和导出功能（Export SVG）。这种设计在视觉上较为复杂，且占用了宝贵的垂直空间。

用户反馈希望获得一个更简洁的画布体验，类似于专业绘图工具（如 Figma、Excalidraw）的交互模式。

## Goals / Non-Goals

**Goals:**
- 将预览面板简化为一个纯净的画布界面
- 使用鼠标滚轮直接进行缩放（无需按住 Ctrl）
- 提供右键菜单作为导出功能的入口
- 移除所有页面滚动，整个区域作为画布

**Non-Goals:**
- 添加新的导出格式（如 PNG、PDF）
- 实现触摸板/手势支持
- 添加图层面板或其他高级画布功能
- 修改 Mermaid 渲染逻辑

## Decisions

### 1. 移除工具栏而非隐藏
**选择**: 完全移除顶部工具栏，而非提供隐藏选项。
**理由**:
- 简化代码维护，避免条件渲染逻辑
- 右键菜单提供了足够的功能访问
- 符合极简设计原则

**替代方案考虑**:
- 可折叠工具栏 - 增加了交互复杂度
- 悬浮工具栏 - 遮挡画布内容

### 2. 滚轮直接缩放 vs Ctrl+滚轮
**选择**: 直接使用滚轮进行缩放，不再需要按住 Ctrl。
**理由**:
- 更接近专业设计工具的使用习惯
- 预览面板内滚轮的默认行为就是缩放（没有其他滚动内容）
- 减少用户学习成本

**风险缓解**:
- 保留平滑缩放过渡，避免突兀的跳跃感
- 设置合理的缩放范围限制 (0.3x - 3x)

### 3. 原生右键菜单 vs 自定义菜单
**选择**: 使用自定义右键菜单而非浏览器原生菜单。
**理由**:
- 提供一致的 VS Code 风格体验
- 可以精确控制菜单内容和样式
- 避免浏览器默认菜单项的干扰

**实现方式**:
- 监听 `contextmenu` 事件
- 阻止默认行为
- 显示自定义 HTML 菜单元素
- 点击外部区域关闭菜单

### 4. 布局: 全屏画布 vs 居中画布
**选择**: 画布占满整个视口，图表在画布内居中。
**理由**:
- 最大化可用绘制空间
- 缩放时保持图表在视野范围内
- 避免不必要的空白区域

**实现细节**:
- body 和容器元素设置为 `overflow: hidden`
- 使用 `width: 100vw; height: 100vh` 占满视口
- SVG 元素使用绝对定位，通过 transform 进行缩放和平移

## Risks / Trade-offs

| 风险 | 影响 | 缓解措施 |
|------|------|----------|
| 用户不习惯滚轮直接缩放 | 中 | 首次使用时显示提示；保持缩放过渡平滑 |
| 右键菜单与系统菜单冲突 | 低 | 仅在画布区域内拦截右键；保留 Shift+右键访问系统菜单 |
| 小尺寸图表难以操作 | 低 | 默认 fit-to-screen；最小缩放限制确保可操作性 |
| 触摸设备无右键菜单 | 低 | 触摸设备非主要使用场景；后续可添加长按菜单 |

## Migration Plan

**部署步骤:**
1. 更新 `previewPanel.ts` 中的 HTML 模板
2. 移除工具栏相关 CSS 和 JavaScript
3. 添加右键菜单实现
4. 修改滚轮事件处理逻辑
5. 调整画布布局样式

**回滚策略:**
- 变更仅影响前端展示层，不涉及数据模型或 API
- 可通过 git revert 快速回滚
- 无数据迁移风险

## Open Questions

1. 是否需要保留键盘快捷键（如 Ctrl+0 重置缩放）？
   - 建议：保留，作为辅助功能

2. 右键菜单是否需要支持更多选项（如 Copy, Paste）？
   - 建议：当前只保留 Export SVG，保持简洁

3. 是否需要显示当前缩放比例？
   - 建议：V2 可考虑，V1 保持极简
