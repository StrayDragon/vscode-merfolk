%% 状态机图 - 订单处理流程
stateDiagram-v2
    [*] --> Created: 创建订单

    Created --> Paid: 支付成功
    Created --> Cancelled: 取消订单
    Created --> Expired: 订单过期

    Paid --> Processing: 开始处理
    Paid --> Refunded: 申请退款

    Processing --> Shipped: 已发货
    Processing --> Failed: 处理失败
    Failed --> Processing: 重试处理

    Shipped --> Delivered: 已送达
    Shipped --> Returned: 退货申请

    Delivered --> [*]: 订单完成
    Returned --> Refunding: 退款中

    Refunding --> Refunded: 退款成功
    Refunded --> [*]: 订单关闭

    Cancelled --> [*]
    Expired --> [*]

    note right of Created
        %% Python 代码示例：
        def create_order():
            """
            @action: render_state_diagram
            @type: state_machine
            Creates a new order with status 'Created'
            """
            order = Order(status='Created')
            return order
    end note

    note left of Paid
        # JavaScript 代码示例：
        function processPayment(order) {
            /**
             * @action: render_state_diagram
             * @type: transition
             * Transition order from 'Created' to 'Paid'
             */
            if (paymentSuccess) {
                order.status = 'Paid';
            }
            return order;
        }
    end note