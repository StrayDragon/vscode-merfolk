%% CI/CD 流水线图
graph LR
    subgraph "开发阶段"
        Dev[开发者] --> Commit[提交代码]
        Commit --> Push[推送到仓库]
    end

    subgraph "CI 持续集成"
        Push --> Trigger[触发构建]
        Trigger --> Build[编译构建]
        Build --> Test[运行测试]
        Test --> Lint[代码检查]

        Lint --> Check{检查结果}
        Check -->|失败| NotifyFailure[通知失败]
        Check -->|成功| Package[打包应用]

        NotifyFailure --> Dev
    end

    subgraph "CD 持续部署"
        Package --> Deploy[部署到测试环境]
        Deploy --> SmokeTest[冒烟测试]

        SmokeTest --> Decision{是否通过?}
        Decision -->|否| Rollback[回滚]
        Decision -->|是| Production[部署到生产]

        Rollback --> Deploy
        Production --> Monitor[监控应用]
    end

    subgraph "相关资源"
        Docs[<a href="MermaidChart:../architecture/system-design.mmd">系统架构设计</a>]
        CodeReview[<a href="MermaidChart:code-review.mmd">代码审查流程</a>]
        Database[<a href="MermaidChart:../architecture/database-schema.mmd">数据库设计</a>]
    end

    Monitor -.-> Docs
    Dev -.-> CodeReview
    Deploy -.-> Database

    %% Python 代码注释示例
    note right of Test
        def run_tests():
            """
            @action: render_pipeline_step
            @type: test_stage
            Runs unit tests and integration tests
            """
            pytest.run()
            coverage.report()
    end note

    note left of Deploy
        # JavaScript 部署脚本
        function deploy(environment) {
            /**
             * @action: render_pipeline_step
             * @type: deploy_stage
             * Deploy application to specified environment
             */
            const config = loadConfig(environment);
            return deployApp(config);
        }
    end note